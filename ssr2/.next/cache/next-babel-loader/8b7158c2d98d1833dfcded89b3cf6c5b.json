{"ast":null,"code":"\"use strict\";\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\nfunction _regenerator() { /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ var e, t, r = \"function\" == typeof Symbol ? Symbol : {}, n = r.iterator || \"@@iterator\", o = r.toStringTag || \"@@toStringTag\"; function i(r, n, o, i) { var c = n && n.prototype instanceof Generator ? n : Generator, u = Object.create(c.prototype); return _regeneratorDefine2(u, \"_invoke\", function (r, n, o) { var i, c, u, f = 0, p = o || [], y = !1, G = { p: 0, n: 0, v: e, a: d, f: d.bind(e, 4), d: function d(t, r) { return i = t, c = 0, u = e, G.n = r, a; } }; function d(r, n) { for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) { var o, i = p[t], d = G.p, l = i[2]; r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0)); } if (o || r > 1) return a; throw y = !0, n; } return function (o, p, l) { if (f > 1) throw TypeError(\"Generator is already running\"); for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) { i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u); try { if (f = 2, i) { if (c || (o = \"next\"), t = i[o]) { if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\"); if (!t.done) return t; u = t.value, c < 2 && (c = 0); } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1); i = e; } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break; } catch (t) { i = e, c = 1, u = t; } finally { f = 1; } } return { value: t, done: y }; }; }(r, o, i), !0), u; } var a = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} t = Object.getPrototypeOf; var c = [][n] ? t(t([][n]())) : (_regeneratorDefine2(t = {}, n, function () { return this; }), t), u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c); function f(e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, _regeneratorDefine2(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, _regeneratorDefine2(u, \"constructor\", GeneratorFunctionPrototype), _regeneratorDefine2(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", _regeneratorDefine2(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), _regeneratorDefine2(u), _regeneratorDefine2(u, o, \"Generator\"), _regeneratorDefine2(u, n, function () { return this; }), _regeneratorDefine2(u, \"toString\", function () { return \"[object Generator]\"; }), (_regenerator = function _regenerator() { return { w: i, m: f }; })(); }\nfunction _regeneratorDefine2(e, r, n, t) { var i = Object.defineProperty; try { i({}, \"\", {}); } catch (e) { i = 0; } _regeneratorDefine2 = function _regeneratorDefine(e, r, n, t) { if (r) i ? i(e, r, { value: n, enumerable: !t, configurable: !t, writable: !t }) : e[r] = n;else { var o = function o(r, n) { _regeneratorDefine2(e, r, function (e) { return this._invoke(r, n, e); }); }; o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2); } }, _regeneratorDefine2(e, r, n, t); }\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nexports.__esModule = true;\nexports[\"default\"] = void 0;\nvar _router = _interopRequireDefault(require(\"next/router\"));\nvar _onDemandEntriesUtils = require(\"./on-demand-entries-utils\");\nvar _default = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(_ref) {\n    var assetPrefix;\n    return _regenerator().w(function (_context) {\n      while (1) switch (_context.n) {\n        case 0:\n          assetPrefix = _ref.assetPrefix;\n          _router[\"default\"].ready(function () {\n            _router[\"default\"].events.on('routeChangeComplete', _onDemandEntriesUtils.setupPing.bind(void 0, assetPrefix, function () {\n              return _router[\"default\"].pathname;\n            }));\n          });\n          (0, _onDemandEntriesUtils.setupPing)(assetPrefix, function () {\n            return _router[\"default\"].pathname;\n          }, _onDemandEntriesUtils.currentPage); // prevent HMR connection from being closed when running tests\n          if (!process.env.__NEXT_TEST_MODE) {\n            document.addEventListener('visibilitychange', function (_event) {\n              var state = document.visibilityState;\n              if (state === 'visible') {\n                (0, _onDemandEntriesUtils.setupPing)(assetPrefix, function () {\n                  return _router[\"default\"].pathname;\n                }, true);\n              } else {\n                (0, _onDemandEntriesUtils.closePing)();\n              }\n            });\n            window.addEventListener('beforeunload', function () {\n              (0, _onDemandEntriesUtils.closePing)();\n            });\n          }\n        case 1:\n          return _context.a(2);\n      }\n    }, _callee);\n  }));\n  return function _default(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexports[\"default\"] = _default;","map":{"version":3,"sources":["../../../client/dev/on-demand-entries-client.js"],"names":["assetPrefix","Router","ready","events","on","setupPing","bind","pathname","currentPage","process","env","__NEXT_TEST_MODE","document","addEventListener","_event","state","visibilityState","window"],"mappings":"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","sourcesContent":["import Router from 'next/router'\nimport { setupPing, currentPage, closePing } from './on-demand-entries-utils'\n\nexport default async ({ assetPrefix }) => {\n  Router.ready(() => {\n    Router.events.on(\n      'routeChangeComplete',\n      setupPing.bind(this, assetPrefix, () => Router.pathname)\n    )\n  })\n\n  setupPing(assetPrefix, () => Router.pathname, currentPage)\n\n  // prevent HMR connection from being closed when running tests\n  if (!process.env.__NEXT_TEST_MODE) {\n    document.addEventListener('visibilitychange', (_event) => {\n      const state = document.visibilityState\n      if (state === 'visible') {\n        setupPing(assetPrefix, () => Router.pathname, true)\n      } else {\n        closePing()\n      }\n    })\n\n    window.addEventListener('beforeunload', () => {\n      closePing()\n    })\n  }\n}\n"]},"metadata":{},"sourceType":"script"}